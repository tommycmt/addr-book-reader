<!DOCTYPE html> 
<html> 
  
<head> 
    <title>Read Text File</title> 
</head> 
  
<body> 
    <input type="file" name="inputfile"
            id="inputfile"> 
    <br> 
   
    <pre id="output"></pre> 
      
    <script type="text/javascript"> 
        var keys = new Set();
        var addresses = [];
        document.getElementById('inputfile') 
            .addEventListener('change', function() { 
              
              

            var fr=new FileReader(); 
            fr.onload=function(){ 
                console.log(fr.result);
                lines = fr.result.split("\n");
                var address = {};
                lines.forEach(function(line) {
                  if (line.length > 1) {
                    kvp = line.split(": ");
                    k = kvp[0];
                    if (!keys.has(k)) {
                      keys.add(k);
                    }
                    v = kvp.slice(1, kvp.length).join(": ");
                    address[k] = v.trim();
                  } else {
                    addresses.push(address);
                    address = {};
                  }
                })
                console.log(addresses); 
                var str = "";
                var s = "";
                keys.forEach(function(key) {
                  s += key + ",";
                })
                str += s + "\n";
                addresses.forEach(function(address) {
                  s = "";
                  keys.forEach(function(key) {
                    if (address[key] != undefined) {
                      s += address[key];
                    }
                    s += ",";
                  })
                  str += s + "\n";
                })
                console.log(str);
                
            }
              
            fr.readAsText(this.files[0]); 
        }) 
    </script> 
</body> 
  
</html> 